<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Infliker Admin</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100">
<div class="max-w-4xl mx-auto mt-10">
  <!-- Login -->
  <div id="auth" class="bg-white p-8 rounded shadow-lg">
    <h2 class="text-2xl font-bold mb-4">Admin Login</h2>
    <input id="email" type="email" placeholder="Email" class="w-full p-2 mb-2 border rounded">
    <input id="password" type="password" placeholder="Password" class="w-full p-2 mb-4 border rounded">
    <button id="login" class="bg-blue-500 text-white px-4 py-2 rounded">Login</button>
  </div>

  <!-- Dashboard -->
  <div id="app" class="hidden bg-white p-8 rounded shadow-lg">
    <h2 class="text-2xl font-bold mb-4">Publish Post</h2>
    <input id="title" placeholder="Title" class="w-full p-2 mb-2 border rounded">
    <input id="slug" placeholder="Slug" class="w-full p-2 mb-2 border rounded">
    <textarea id="content" placeholder="Content" class="w-full p-2 mb-2 border rounded h-40"></textarea>
    <textarea id="excerpt" placeholder="Excerpt" class="w-full p-2 mb-2 border rounded h-20"></textarea>
    <label class="flex items-center mb-2">
      <input type="checkbox" id="published" class="mr-2"> Publish
    </label>
    <button id="publish" class="bg-green-500 text-white px-4 py-2 rounded">Publish</button>
    <p id="status" class="mt-2 font-semibold"></p>
  </div>
</div>

<script>
const apiBase = 'https://api.infliker.fun/api';

// Login
document.getElementById('login').onclick = async ()=>{
  const email = document.getElementById('email').value;
  const password = document.getElementById('password').value;
  const res = await fetch(apiBase+'/auth/login',{ 
    method:'POST',
    headers:{'Content-Type':'application/json'},
    body:JSON.stringify({email,password})
  });
  const data = await res.json();
  if(res.ok){
    localStorage.setItem('token', data.token);
    document.getElementById('auth').style.display='none';
    document.getElementById('app').style.display='block';
  } else alert(data.error);
}

// Publish Post
document.getElementById('publish').onclick = async ()=>{
  const body = {
    title:document.getElementById('title').value,
    slug:document.getElementById('slug').value,
    content:document.getElementById('content').value,
    excerpt:document.getElementById('excerpt').value,
    published:document.getElementById('published').checked
  };
  const token = localStorage.getItem('token');
  const res = await fetch(apiBase+'/posts',{
    method:'POST',
    headers:{
      'Content-Type':'application/json',
      'Authorization':`Bearer ${token}`
    },
    body:JSON.stringify(body)
  });
  const data = await res.json();
  document.getElementById('status').innerText = data.ok ? 'Published âœ…' : `Error: ${data.error}`;
}
</script>
</body>
</html>
